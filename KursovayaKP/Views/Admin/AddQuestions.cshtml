@model Tuple<QuestionModel, List<TestModel>>
@{
    ViewData["Title"] = "Добавление вороса";
}

@section Styles {
    <link rel="stylesheet" href="~/css/Add.css" asp-append-version="true" />
    <script src="~/js/AddQuestions.js" asp-append-version="true"></script>
}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/fontawesome.min.css" integrity="sha512-RvQxwf+3zJuNwl4e0sZjQeX7kUa3o82bDETpgVCH2RiwYSZVDdFJ7N/woNigN/ldyOOoKw8584jM4plQdt8bhA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<body>
    <div class="fullscreen-container">
        <div class="addquestion-container">
            <h1 class="header">Добавление вопроса</h1>
            <form class="form" id="questionForm">
                <div class="input-group">
                    <label for="Topic">Тест</label>
                    <select id="test" name="test" required>
                        @foreach (TestModel testModel in Model.Item2)
                        {
                            <option value=@testModel.IdTest>@testModel.NameTest</option>
                        }
                    </select>
                </div>

                <div class="input-group">
                    <label for="questionText">Вопрос</label>
                    <input type="text" id="questionText" name="questionText" placeholder="Введите вопрос" required asp-for="@Model.Item1.QuestionText">
                    <span asp-validation-for="@Model.Item1.QuestionText" style="color: red; font-size: 12px; display: block; height: 12px;"></span>
                </div>

                <div class="input-group">
                    <label for="LinkPhoto">Ссылка на фото(при необходимости)</label>
                    <input type="text" id="linkPhoto" name="linkPhoto" placeholder="Укажите ссылку на фото(при необходимости)" asp-for="@Model.Item1.LinkPhoto">
                    <span asp-validation-for="@Model.Item1.LinkPhoto" style="color: red; font-size: 12px; display: block; height: 12px;"></span>
                </div>

                <div class="input-group">
                    <label for="Answer1">Ответ 1</label>
                    <input type="text" id="answer1" name="answer1" placeholder="Введите первй ответ" required asp-for="@Model.Item1.Answer1">
                    <span asp-validation-for="@Model.Item1.Answer1" style="color: red; font-size: 12px; display: block; height: 12px;"></span>
                </div>

                <div class="input-group">
                    <label for="Answer2">Ответ 2</label>
                    <input type="text" id="answer2" name="answer2" placeholder="Введите второй ответ" required asp-for="@Model.Item1.Answer2">
                    <span asp-validation-for="@Model.Item1.Answer2" style="color: red; font-size: 12px; display: block; height: 12px;"></span>
                </div>

                <div class="input-group">
                    <label for="Answer3">Ответ 3</label>
                    <input type="text" id="answer3" name="answer3" placeholder="Введите третий ответ" required asp-for="@Model.Item1.Answer3">
                    <span asp-validation-for="@Model.Item1.Answer3" style="color: red; font-size: 12px; display: block; height: 12px;"></span>
                </div>

                <div class="input-group">
                    <label for="Answer4">Ответ 4</label>
                    <input type="text" id="answer4" name="answer4" placeholder="Введите четвертый ответ" required asp-for="@Model.Item1.Answer4">
                    <span asp-validation-for="@Model.Item1.Answer4" style="color: red; font-size: 12px; display: block; height: 12px;"></span>
                </div>

                <div class="input-group">
                    <label for="CorrectAnswer">Правильный ответ</label>
                    <input type="text" id="correctAnswer" name="correctAnswer" placeholder="Введите правильеый ответ" required asp-for="@Model.Item1.CorrectAnswer">
                    <span asp-validation-for="@Model.Item1.CorrectAnswer" style="color: red; font-size: 12px; display: block; height: 12px;"></span>
                </div>

                <ul id="testList"></ul>

                <input class="button" type="submit" value="Добавить вопрос">
                <div class="text-center">
                    <a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="TrafficRegulations">Все вопросы</a>
                    <a class="nav-link text-dark" asp-area="" asp-controller="Admin" asp-action="AdminIndex">Назад</a>
                </div>
            </form>
        </div>
    </div>
</body>

<script>
    // Обработчик события submit для формы
    document.getElementById("questionForm").addEventListener("submit", function (event) {
        event.preventDefault(); // Предотвращаем отправку формы по умолчанию

        // Получаем данные из формы
        var idTest = document.getElementById("test").value;
        var questionText = document.getElementById("questionText").value;
        var linkPhotoElement = document.getElementById("linkPhoto");
        var linkPhoto = linkPhotoElement !== null ? linkPhotoElement.value : "";
        var answer1 = document.getElementById("answer1").value;
        var answer2 = document.getElementById("answer2").value;
        var answer3 = document.getElementById("answer3").value;
        var answer4 = document.getElementById("answer4").value;
        var correctAnswer = document.getElementById("correctAnswer").value;

        console.log("idTest:", idTest);
        console.log("questionText:", questionText);
        console.log("linkPhoto:", linkPhoto);
        console.log("answer1:", answer1);
        console.log("answer2:", answer2);
        console.log("answer3:", answer3);
        console.log("answer4:", answer4);
        console.log("correctAnswer:", correctAnswer);

        // Создаем объект с данными вопроса
        var questionData = {
            idTest: idTest,
            questionText: questionText,
            linkPhoto: linkPhoto,
            answer1: answer1,
            answer2: answer2,
            answer3: answer3,
            answer4: answer4,
            correctAnswer: correctAnswer,
        };
        
        // Выполняем AJAX-запрос на сервер
        $.ajax({
            url: '/Admin/AddQuestions',
            type: 'POST',
            contentType: 'application/x-www-form-urlencoded',
            data: questionData,
            success: function (result) {
                // Обрабатываем успешный ответ
            },
            error: function (error) {
                // Обрабатываем ошибку
            }
        });
        location.reload();
    });
</script>